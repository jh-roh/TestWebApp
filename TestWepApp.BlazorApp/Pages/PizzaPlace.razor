@page "/pizzaplace"
@inject IMenuService menuService
@inject IOrderService orderService

<h3>PizzaPlace</h3>

<PizzaList Title="Out Selection of Pizzas"
           Items="@State.Menu.Pizzas"
           ButtonTitle="Order"
           ButtonClass="btn btn-success pl-4 pr-4" Selected="@AddToBasket"></PizzaList>

<ShoppingBasket Orders="@State.Basket.Orders" GetPizzaFromId="@State.Menu.GetPizza" Selected="@RemoveFromBasket"></ShoppingBasket>

@State.ToJson()



@code {
    private State State { get; } = new State();

    protected override async Task OnInitializedAsync()
    {
        Console.WriteLine($"{0}", "OnInitializedAsync");

        Menu menu = await menuService.GetMenu();

        // State.Menu.Add(new Pizza(1, "Pepperoni", 8.99M, Spiciness.Spicy));
        // State.Menu.Add(new Pizza(2, "Margarita", 7.99M, Spiciness.None));
        // State.Menu.Add(new Pizza(3, "Diabolo", 9.99M, Spiciness.Hot));

        foreach(Pizza pizza in menu.Pizzas)
        {
            State.Menu.Add(pizza);
        }



    }
    private void AddToBasket(Pizza pizza) => State.Basket.Add(pizza.Id);

    private void RemoveFromBasket(int id) => State.Basket.RemoveAt(id);

    private async Task PlaceOrder()
    {
        await orderService.PlaceOrder(State.Basket);
    }

}
